# ステガノグラフィーAPI設計書

## 1. 概要
このAPIは、画像へのステガノグラフィー（情報の秘匿）機能を提供します。テキスト情報を画像に埋め込んだり、埋め込まれた情報を抽出したりすることができます。

## 2. ベースURL
```
https://www.secret-message.site/
```

## 3. エンドポイント

### 3.1 画像へのテキスト埋め込み
- **エンドポイント**: `/embed`
- **メソッド**: POST
- **説明**: 画像にテキストを埋め込みます。

#### リクエスト
- Content-Type: multipart/form-data

| パラメータ名 | 型     | 必須 | 説明                   |
|--------------|--------|------|------------------------|
| image        | File   | はい | 埋め込み先の画像ファイル |
| string       | String | はい | 埋め込むテキスト        |

#### レスポンス
- Content-Type: image/png
- 埋め込み処理後の画像ファイル

#### エラーレスポンス
- Content-Type: application/json

| ステータスコード | エラーメッセージ              | 説明                           |
|------------------|-------------------------------|--------------------------------|
| 400              | No file part                  | ファイルが送信されていない     |
| 400              | No selected file              | ファイルが選択されていない     |
| 400              | File type not allowed         | 許可されていないファイル形式   |
| 400              | File size exceeds the limit   | ファイルサイズが上限を超えている |
| 416              | String size exceeds the limit | 文字列のサイズが上限を超えている |
| 500              | Internal Server Error         | サーバー内部エラー             |

### 3.2 画像からのテキスト抽出
- **エンドポイント**: `/extract`
- **メソッド**: POST
- **説明**: 画像から埋め込まれたテキストを抽出します。

#### リクエスト
- Content-Type: multipart/form-data

| パラメータ名 | 型   | 必須 | 説明                   |
|--------------|------|------|------------------------|
| image        | File | はい | テキストが埋め込まれた画像ファイル |

#### レスポンス
- Content-Type: application/json; charset=utf-8

```json
{
  "extracted_string": "抽出されたテキスト"
}
```

#### エラーレスポンス
- Content-Type: application/json

| ステータスコード | エラーメッセージ              | 説明                           |
|------------------|-------------------------------|--------------------------------|
| 400              | No file part                  | ファイルが送信されていない     |
| 400              | No selected file              | ファイルが選択されていない     |
| 400              | File type not allowed         | 許可されていないファイル形式   |
| 413              | File size exceeds the limit   | ファイルサイズが上限を超えている |
| 500              | Internal Server Error         | サーバー内部エラー             |

## 4. 制限事項
- 許可されるファイル形式: png, jpg, jpeg, gif
- 最大ファイルサイズ: 10MB
- 埋め込み可能な最大文字数: 2048バイト（UTF-8エンコード）

## 5. セキュリティ
- 入力されたテキストはエスケープ処理が行われます。
- ファイル名は`secure_filename`関数によって安全な形式に変換されます。

## 6. エラーハンドリング
すべてのエラーは適切なHTTPステータスコードとともにJSON形式で返されます。

